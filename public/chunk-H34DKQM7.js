import{I as l,L as s,Lb as a,Tb as g,ba as i}from"./chunk-LULYJDTR.js";var m=class o{constructor(t,e){this.http=t;this.router=e;this.restoreSession()}apiUrl="http://localhost:5000/api/auth";isLoggedIn=i(!1);isAdminSignal=i(!1);isVendedorSignal=i(!1);isClienteSignal=i(!1);nombreUsuario=i("");login(t,e){return this.http.post(`${this.apiUrl}/login`,{correo:t,contrasena:e})}register(t){return this.http.post(`${this.apiUrl}/register`,t)}guardarSesion(t,e,r,n){localStorage.setItem("token",t),localStorage.setItem("rol",e),localStorage.setItem("nombre",r),localStorage.setItem("userId",n),this.isLoggedIn.set(!0),this.isAdminSignal.set(e==="admin"),this.isVendedorSignal.set(e==="vendedor"),this.isClienteSignal.set(e==="cliente"),this.nombreUsuario.set(r)}logout(){localStorage.removeItem("token"),localStorage.removeItem("rol"),localStorage.removeItem("nombre"),localStorage.removeItem("userId"),this.isLoggedIn.set(!1),this.isAdminSignal.set(!1),this.isVendedorSignal.set(!1),this.isClienteSignal.set(!1),this.nombreUsuario.set(""),this.router.navigate(["/login"])}restoreSession(){let t=localStorage.getItem("token"),e=localStorage.getItem("rol"),r=localStorage.getItem("nombre"),n=localStorage.getItem("userId");t&&e&&r&&n&&(this.isLoggedIn.set(!0),this.isAdminSignal.set(e==="admin"),this.isVendedorSignal.set(e==="vendedor"),this.isClienteSignal.set(e==="cliente"),this.nombreUsuario.set(r))}actualizarPerfil(t){let e=this.getToken();return this.http.put(`${this.apiUrl}/actualizar-perfil`,t,{headers:{Authorization:`Bearer ${e}`}}).pipe(r=>(this.nombreUsuario.set(t.nombre),localStorage.setItem("nombre",t.nombre),r))}getToken(){return localStorage.getItem("token")}getRol(){return localStorage.getItem("rol")}getNombre(){return localStorage.getItem("nombre")}getUserId(){return localStorage.getItem("userId")}getUser(){return{_id:this.getUserId(),rol:this.getRol(),token:this.getToken(),nombre:this.getNombre()}}isAdmin(){return this.getRol()==="admin"}isVendedor(){return this.getRol()==="vendedor"}isCliente(){return this.getRol()==="cliente"}static \u0275fac=function(e){return new(e||o)(s(a),s(g))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{m as a};
