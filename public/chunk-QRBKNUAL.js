import{a as c}from"./chunk-H34DKQM7.js";import{I as o,L as s,i as a}from"./chunk-LULYJDTR.js";var n=class i{constructor(t){this.authService=t;this.cargarCarrito()}items=[];carritoSubject=new a([]);carrito$=this.carritoSubject.asObservable();obtenerClaveLocalStorage(){let t=this.authService.getUser();return t&&t._id?`carrito_${t._id}`:"carrito_invitado"}cargarCarrito(){let t=this.obtenerClaveLocalStorage(),r=localStorage.getItem(t);if(r)try{this.items=JSON.parse(r)}catch{this.items=[]}else this.items=[];this.carritoSubject.next([...this.items])}actualizarEstado(){let t=this.obtenerClaveLocalStorage();localStorage.setItem(t,JSON.stringify(this.items)),this.carritoSubject.next([...this.items])}recargarCarritoPorUsuario(){this.cargarCarrito()}agregarAlCarrito(t,r){let e=this.items.findIndex(m=>m.producto._id===t._id);e!==-1?this.items[e].cantidad+=r:this.items.push({producto:t,cantidad:r}),this.actualizarEstado()}obtenerCarrito(){return[...this.items]}eliminarDelCarrito(t){this.items=this.items.filter(r=>r.producto._id!==t),this.actualizarEstado()}vaciarCarrito(){this.items=[],this.actualizarEstado()}obtenerTotal(){return this.items.reduce((t,r)=>t+r.producto.precio*r.cantidad,0)}obtenerCantidadTotal(){return this.items.reduce((t,r)=>t+r.cantidad,0)}carritoVacio(){return this.items.length===0}limpiarTemporal(){this.items=[]}static \u0275fac=function(r){return new(r||i)(s(c))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};export{n as a};
